<?xml version="1.0"?>

<launch>

  <node name="rqt_console" pkg="rqt_console" type="rqt_console" output="screen" />

  <arg name="world_name" default="worlds/empty.world"/>
  <arg name="laser_enabled" default="true"/>
  <arg name="ur5_enabled" default="false"/>
  <arg name="kinect_enabled" default="false"/>

  <include file="$(find gazebo_ros)/launch/empty_world.launch">
    <arg name="world_name" value="$(arg world_name)"/> <!-- world_name is wrt GAZEBO_RESOURCE_PATH environment variable -->
    <arg name="paused" value="false"/>
    <arg name="use_sim_time" value="true"/>
    <arg name="gui" value="true"/>
    <arg name="headless" value="false"/>
    <arg name="debug" value="false"/>
  </include>
  

  <!--param name="robot_description" command="$(find xacro)/xacro.py '$(env HUSKY_GAZEBO_DESCRIPTION)'-->  
  <arg name="ns1" value="h1" />
  <group ns="$(arg ns1)">
    <param name="tf_prefix" value="h1_tf" />
    <param name="robot_description" command="$(find xacro)/xacro.py '$(find multihusky)/xacro/mydesc.gazebo.xacro'
	laser_enabled:=$(arg laser_enabled)
	ur5_enabled:=$(arg ur5_enabled)
	kinect_enabled:=$(arg kinect_enabled)
	prefix:=$(arg ns1)
	" />
    <!--<param name="tf_prefix" value="h1_tf" />-->
    <include file="$(find multihusky)/launch/one_husky.launch">
      <arg name="init_pose" value="-x 1 -y 1 -z 0" />
      <arg name="robot_name" value="NpsHusky1" />
      <arg name="ns" value="$(arg ns1)" />
    </include>
  <node pkg="robot_localization" type="ekf_localization_node" name="ekf_localization">
    <rosparam command="load" file="$(find multihusky)/config/localization1.yaml" />
  </node>

  </group>


  <arg name="ns2" value="h2" />
  <group ns="$(arg ns2)">
    <param name="tf_prefix" value="h2_tf" />
    <param name="robot_description" command="$(find xacro)/xacro.py '$(find multihusky)/xacro/mydesc.gazebo.xacro'
    laser_enabled:=$(arg laser_enabled)
    ur5_enabled:=$(arg ur5_enabled)
    kinect_enabled:=$(arg kinect_enabled)
    prefix:=$(arg ns2)
    " />
  <!--<param name="tf_prefix" value="h1_tf" />-->
  <include file="$(find multihusky)/launch/one_husky.launch">
    <arg name="init_pose" value="-x -1 -y -1 -z 0" />
    <arg name="robot_name" value="NpsHusky2" />
    <arg name="ns" value="$(arg ns2)" />
  </include>
  <node pkg="robot_localization" type="ekf_localization_node" name="ekf_localization">
    <rosparam command="load" file="$(find multihusky)/config/localization2.yaml" />
  </node>
  </group>

  <!--
  <group ns="h2">
  <param name="robot_description" command="$(find xacro)/xacro.py '$(find gazebotesting)/xacro/mydesc2.gazebo.xacro'
    laser_enabled:=$(arg laser_enabled)
    ur5_enabled:=$(arg ur5_enabled)
    kinect_enabled:=$(arg kinect_enabled)
    " />
  <include file="$(find gazebotesting)/launch/one_husky.launch">
    <arg name="init_pose" value="-x -2 -y -2 -z 0" />
    <arg name="robot_name" value="NpsHusky2" />
  </include>
  </group>
  -->

<!--
<node name="rviz" pkg="rviz" type="rviz" args="-d $(find husky_viz)/rviz/robot.rviz" output="screen"/>
-->
<node name="rviz" pkg="rviz" type="rviz" args="-d $(find multihusky)/rviz/robot.rviz" output="screen"/>

<node name="rqt_graph" pkg="rqt_graph" type="rqt_graph" output="screen" />

<node name="rqt_topic" pkg="rqt_topic" type="rqt_topic" output="screen" />
</launch>
